# ===================================================================
# ADVANCED CUSTOMER SUPPORT SYSTEM TASKS CONFIGURATION  
# Sequential workflow for comprehensive customer support handling
# ===================================================================

# PHASE 1: TICKET CLASSIFICATION AND ANALYSIS
# ===================================================================

ticket_classification_task:
  description: >
    Perform comprehensive analysis of the incoming customer query to ensure
    proper routing, prioritization, and response strategy:

    1. **Urgency Classification**: Classify urgency level (Critical/High/Medium/Low) 
       based on keywords, context, and potential business impact
    2. **Issue Categorization**: Determine category (Technical/Billing/Account/Product/General)
       based on content analysis and keywords
    3. **Sentiment Analysis**: Analyze customer emotional state, frustration level,
       and communication tone to tailor response approach
    4. **Information Extraction**: Extract specific details, account references,
       error codes, product mentions, and actionable data
    5. **Complexity Assessment**: Evaluate technical complexity, required expertise,
       and estimated resolution difficulty
    6. **Special Handling**: Identify VIP customers, legal issues, escalation triggers,
       or compliance requirements

    **Input Context:**
    - Customer Query: {topic}
    - User Context: {user_context}
    - Current Year: {current_year}
    - Session Context: Available user session data
    - Historical Context: Previous interaction patterns

  expected_output: >
    **TICKET ANALYSIS REPORT**

    **Classification Results:**
    - Urgency Level: [Critical/High/Medium/Low] with detailed reasoning
    - Issue Category: [Technical/Billing/Account/Product/General] with subcategory
    - Customer Sentiment: [Satisfied/Neutral/Frustrated/Angry] with tone analysis
    
    **Key Information Extracted:**
    - Primary Issue: [Core problem statement]
    - Secondary Issues: [Related concerns or dependencies]
    - Customer Details: [Account info, product usage, technical environment]
    - Specific Data: [Error codes, reference numbers, dates, amounts]
    
    **Handling Requirements:**
    - Complexity Level: [Simple/Moderate/Complex/Expert Required]
    - Estimated Resolution Time: [Immediate/Within 1 hour/Same day/Multiple days]
    - Special Flags: [VIP/Legal/Compliance/Escalation Required/Privacy Concern]
    - Recommended Team: [Tier 1/Tier 2/Specialist Team/Management]

  agent: ticket_classifier

# PHASE 2: SESSION AND CONTEXT MANAGEMENT
# ===================================================================

manage_user_session:
  description: >
    Manage customer session context and retrieve relevant historical information
    to provide personalized, continuous support experience:

    1. **Session Initialization**: Create or retrieve existing customer session
       with unique identifiers and security validation
    2. **History Retrieval**: Pull relevant conversation history, previous issues,
       resolution outcomes, and customer preferences  
    3. **Context Building**: Compile customer profile including account status,
       product usage patterns, and communication preferences
    4. **Personalization Data**: Gather preferences for communication style,
       technical detail level, and response format
    5. **Relationship Mapping**: Identify related cases, ongoing issues,
       or connected account problems
    6. **Privacy Compliance**: Ensure data access complies with privacy policies
       and customer consent requirements

    **Input Context:**
    - Ticket Classification: {ticket_classification_task}
    - User ID: {user_id}  
    - Session ID: {session_id}
    - Historical Data: Available conversation history
    - Account Information: Customer account status and details

  expected_output: >
    **SESSION MANAGEMENT REPORT**

    **Session Details:**
    - Session ID: [Unique session identifier]
    - Customer ID: [Verified customer identifier] 
    - Authentication Status: [Verified/Pending/Anonymous]
    - Session Type: [New/Continuing/Escalated]

    **Historical Context:**
    - Previous Interactions: [Summary of last 5 interactions with outcomes]
    - Recurring Issues: [Patterns in customer problems or requests]
    - Resolution History: [Success/failure patterns and customer feedback]
    - Preferences: [Communication style, technical detail level, contact preferences]

    **Customer Profile:**
    - Account Status: [Active/Suspended/Premium/Trial]
    - Product Usage: [Products used, usage patterns, subscription level]
    - Support History: [Ticket volume, satisfaction scores, escalation history]
    - Special Notes: [VIP status, accessibility needs, language preferences]

    **Personalization Recommendations:**
    - Communication Style: [Formal/Casual/Technical/Simple]
    - Response Format: [Detailed steps/Quick summary/Visual aids/Phone callback]
    - Follow-up Preferences: [Email/SMS/Phone/In-app notification]

  agent: session_manager

# PHASE 3: KNOWLEDGE BASE RETRIEVAL
# ===================================================================

kb_retrieval_task:
  description: >
    Search internal knowledge bases and documentation to find relevant information
    for addressing the customer's specific query and situation:

    1. **Query Enhancement**: Expand search terms based on ticket classification
       and customer context to improve retrieval accuracy
    2. **Multi-source Search**: Query FAQ databases, technical documentation,
       troubleshooting guides, and solution articles
    3. **Relevance Ranking**: Score and rank results based on query match,
       customer context, and historical effectiveness
    4. **Content Filtering**: Filter results by customer's product access,
       account level, and technical expertise  
    5. **Freshness Validation**: Verify information currency and flag
       outdated content that needs review
    6. **Gap Identification**: Identify knowledge gaps where additional
       information sources may be needed

    **Input Context:**
    - Ticket Classification: {ticket_classification_task}
    - Customer Context: Product usage, account level, technical expertise
    - Search Parameters: Enhanced query terms and filtering criteria
    - Knowledge Base: Internal FAQ, documentation, and solution repositories

  expected_output: >
    **KNOWLEDGE BASE SEARCH RESULTS**

    **Primary Results:**
    - Exact Matches: [Solutions that directly address the customer query]
    - Related Solutions: [Similar problems and their resolutions]
    - Troubleshooting Steps: [Diagnostic and resolution procedures]
    - Product Documentation: [Relevant feature guides and specifications]

    **Search Metadata:**
    - Search Terms Used: [Original and enhanced query terms]
    - Results Count: [Total results found and filtered]
    - Relevance Scores: [Confidence levels for top results]
    - Content Freshness: [Last updated dates and currency assessment]

    **Knowledge Gaps:**
    - Missing Information: [Areas where internal knowledge is insufficient]
    - Update Needs: [Outdated content requiring revision]
    - External Search Recommendations: [Suggested external information needs]

    **Content Summary:**
    - Available Solutions: [Count and types of solutions found]
    - Complexity Level: [Technical difficulty of available solutions]
    - Resolution Completeness: [How fully the query can be addressed]

  agent: kb_retriever

# PHASE 4: POLICY AND COMPLIANCE RETRIEVAL
# ===================================================================

retrieve_company_policies:
  description: >
    Retrieve and interpret relevant company policies, procedures, and compliance
    guidelines that apply to the customer's situation:

    1. **Policy Mapping**: Identify applicable policies based on issue category,
       customer type, and requested actions
    2. **Compliance Check**: Verify that potential solutions comply with
       company policies, legal requirements, and industry regulations  
    3. **Authority Validation**: Determine authorization levels required
       for different solution options and escalation paths
    4. **Risk Assessment**: Evaluate potential risks, liabilities,
       and compliance implications of various response options
    5. **Exception Handling**: Identify when policy exceptions might apply
       and what approval processes are required
    6. **Documentation Requirements**: Determine what documentation or
       verification may be needed for compliance

    **Input Context:**
    - Ticket Classification: {ticket_classification_task}
    - Customer Profile: Account type, location, product subscriptions
    - Proposed Actions: Potential solutions and their policy implications
    - Compliance Framework: Applicable laws, regulations, and industry standards

  expected_output: >
    **POLICY AND COMPLIANCE REPORT**

    **Applicable Policies:**
    - Primary Policies: [Main policies governing this type of issue]
    - Related Guidelines: [Supporting procedures and guidelines]
    - Compliance Requirements: [Legal and regulatory obligations]
    - Authorization Levels: [Who can approve different types of solutions]

    **Solution Constraints:**
    - Permitted Actions: [What support agents can do without escalation]
    - Restricted Actions: [Actions requiring higher authorization]
    - Prohibited Actions: [Things that cannot be done under any circumstances]
    - Documentation Needs: [Required paperwork or verification]

    **Risk Assessment:**
    - Compliance Risk: [Potential regulatory or legal issues]
    - Business Risk: [Financial or operational implications]
    - Customer Risk: [Potential negative impact on customer]
    - Mitigation Strategies: [How to minimize identified risks]

    **Escalation Paths:**
    - Standard Escalation: [Normal escalation procedures for this issue type]
    - Exception Handling: [When and how to request policy exceptions]
    - Legal Review: [When legal team involvement is required]
    - Management Approval: [Authorization hierarchy and approval processes]

  agent: policy_retriever

# PHASE 5: EXTERNAL INFORMATION COORDINATION
# ===================================================================

coordinate_web_search:
  description: >
    Coordinate intelligent web searches when internal knowledge is insufficient
    to fully address the customer query:

    1. **Search Need Assessment**: Determine if external information is needed
       based on internal knowledge gaps and query complexity
    2. **Query Optimization**: Develop targeted search queries that will find
       relevant, trustworthy external information
    3. **Source Evaluation**: Identify and prioritize reliable external sources
       including industry documentation, vendor resources, and expert sites
    4. **Information Validation**: Verify external information accuracy and
       relevance to customer's specific situation
    5. **Currency Check**: Ensure external information is current and
       applicable to latest product versions or policies
    6. **Integration Planning**: Prepare external information for integration
       with internal knowledge and policy constraints

    **Input Context:**
    - Knowledge Gaps: {kb_retrieval_task}  
    - Customer Query: {topic}
    - Internal Limitations: Areas where internal knowledge is insufficient
    - Search Parameters: Optimized external search queries

  expected_output: >
    **EXTERNAL INFORMATION COORDINATION REPORT**

    **Search Assessment:**
    - External Search Needed: [Yes/No with detailed reasoning]
    - Information Gaps: [Specific areas requiring external information]
    - Search Priority: [High/Medium/Low based on customer impact]
    - Risk Level: [Risk of providing incomplete information without external sources]

    **Search Strategy:**
    - Search Queries: [Optimized queries for external search engines]
    - Target Sources: [Prioritized list of reliable external sources]
    - Information Types: [Technical docs, vendor info, industry standards, forums]
    - Quality Criteria: [Standards for evaluating external information quality]

    **Search Results:**
    - Relevant Findings: [Key external information that addresses knowledge gaps]
    - Source Quality: [Reliability assessment of information sources]
    - Information Currency: [How current and applicable the information is]
    - Integration Notes: [How external info complements internal knowledge]

    **Recommendations:**
    - Information Usage: [How to best utilize external information]
    - Verification Needs: [What external information needs additional validation]
    - Update Suggestions: [Internal knowledge base updates based on findings]

  agent: web_search_coordinator

# PHASE 6: INFORMATION FUSION AND INTEGRATION
# ===================================================================

information_fusion_task:
  description: >
    Integrate information from all sources (internal KB, policies, external search)
    into a comprehensive, coherent knowledge base for solution development:

    1. **Information Consolidation**: Combine internal knowledge, policy information,
       and external research into unified information packages
    2. **Conflict Resolution**: Identify and resolve conflicts between different
       information sources using reliability and currency criteria
    3. **Relevance Prioritization**: Rank information by relevance to customer
       query, reliability of source, and applicability to customer situation
    4. **Completeness Assessment**: Evaluate whether combined information is
       sufficient for comprehensive solution development
    5. **Quality Validation**: Verify accuracy, currency, and trustworthiness
       of integrated information package
    6. **Gap Documentation**: Document any remaining information gaps that
       might affect solution quality

    **Input Context:**
    - Internal Knowledge: {kb_retrieval_task}
    - Policy Information: {retrieve_company_policies}
    - External Information: {coordinate_web_search}
    - Customer Context: {manage_user_session}

  expected_output: >
    **INTEGRATED INFORMATION REPORT**

    **Information Integration:**
    - Primary Information: [Most relevant and reliable information for the query]
    - Supporting Details: [Additional context and background information]
    - Policy Alignment: [How information aligns with company policies]
    - External Validation: [External sources that support internal information]

    **Quality Assessment:**
    - Information Completeness: [Percentage of query addressable with available info]
    - Source Reliability: [Confidence levels for different information sources]
    - Currency Verification: [How current and up-to-date the information is]
    - Conflict Resolution: [How conflicting information was resolved]

    **Solution Readiness:**
    - Solution Development Ready: [Yes/No with detailed assessment]
    - Information Sufficiency: [Whether available info can create complete solutions]
    - Additional Research Needed: [Any remaining information requirements]
    - Quality Confidence: [Overall confidence in information quality]

    **Recommendations:**
    - Information Usage: [How to best utilize the integrated information]
    - Solution Approach: [Recommended strategy for solution development]
    - Quality Assurance: [Additional validation steps recommended]
    - Follow-up Actions: [Any additional research or verification needed]

  agent: information_fusion_agent

# PHASE 7: SOLUTION GENERATION AND DEVELOPMENT
# ===================================================================

solution_generation_task:
  description: >
    Generate comprehensive, actionable solutions based on integrated information
    and customer context:

    1. **Solution Architecture**: Develop primary solution path with clear,
       step-by-step instructions tailored to customer's technical level
    2. **Alternative Options**: Create backup solutions and alternative approaches
       for different scenarios or if primary solution fails
    3. **Prerequisites and Requirements**: Identify what customer needs to have
       or do before attempting the solution
    4. **Risk Mitigation**: Include warnings, precautions, and recovery steps
       for potential issues during solution implementation
    5. **Escalation Criteria**: Define when and how to escalate if solution
       attempts are unsuccessful
    6. **Success Validation**: Provide ways for customer to verify that
       the solution worked correctly

    **Input Context:**
    - Integrated Information: {information_fusion_task}
    - Customer Profile: Technical level, product usage, account status
    - Ticket Classification: Issue complexity and urgency
    - Policy Constraints: What solutions are permitted and recommended

  expected_output: >
    **COMPREHENSIVE SOLUTION PACKAGE**

    **Primary Solution:**
    - Solution Overview: [High-level summary of recommended approach]
    - Step-by-Step Instructions: [Detailed, numbered steps for solution implementation]
    - Prerequisites: [What customer needs before starting]
    - Expected Outcome: [What customer should see when solution works]

    **Alternative Solutions:**
    - Secondary Approach: [Alternative method if primary solution doesn't work]
    - Workaround Options: [Temporary solutions while working on permanent fix]
    - Advanced Solutions: [More complex options for technically capable users]
    - Escalation Path: [When and how to get additional help]

    **Implementation Support:**
    - Risk Warnings: [Potential issues and how to avoid them]
    - Troubleshooting: [Common problems during implementation and fixes]
    - Verification Steps: [How to confirm the solution worked]
    - Rollback Procedures: [How to undo changes if something goes wrong]

    **Resource References:**
    - Documentation Links: [Relevant guides and documentation]
    - Video Tutorials: [Visual aids for complex procedures]
    - Contact Information: [Who to contact for additional help]
    - Follow-up Timeline: [When to expect results and follow-up communication]

  agent: solution_generator

# PHASE 8: DYNAMIC RESPONSE PERSONALIZATION  
# ===================================================================

dynamic_response_task:
  description: >
    Transform technical solutions into personalized, empathetic, conversational
    responses that match customer's communication style and emotional state:

    1. **Tone Adaptation**: Adapt response tone to customer's emotional state,
       communication style, and relationship history
    2. **Technical Level Matching**: Adjust technical complexity and terminology
       to match customer's demonstrated technical expertise
    3. **Personalization Integration**: Include relevant personal context,
       account history, and previous interaction references  
    4. **Empathy and Acknowledgment**: Address customer frustrations and
       acknowledge their experience and concerns
    5. **Brand Voice Consistency**: Maintain professional company voice while
       being conversational and helpful
    6. **Action Clarity**: Ensure next steps are crystal clear and
       customer feels confident about moving forward

    **Input Context:**
    - Solution Package: {solution_generation_task}
    - Customer Session: {manage_user_session}
    - Customer Sentiment: Emotional state and communication preferences
    - Brand Guidelines: Company voice and communication standards

  expected_output: >
    **PERSONALIZED CUSTOMER RESPONSE**

    **Opening and Acknowledgment:**
    - Empathetic Opening: [Acknowledgment of customer situation and feelings]
    - Issue Understanding: [Confirmation of problem understanding]
    - Personal Touch: [Reference to account history or previous interactions]
    - Solution Preview: [Brief overview of how we'll solve their problem]

    **Main Solution Content:**
    - Clear Instructions: [Step-by-step solution in customer-appropriate language]
    - Visual Aids: [References to screenshots, videos, or diagrams when helpful]
    - Success Indicators: [How customer will know the solution is working]
    - Alternative Options: [Additional approaches if primary solution doesn't work]

    **Support and Follow-up:**
    - Additional Resources: [Links to helpful documentation or tutorials]
    - Contact Options: [How to get additional help if needed]
    - Timeline Expectations: [When to expect results and follow-up]
    - Satisfaction Check: [Invitation for feedback and additional questions]

    **Professional Closing:**
    - Next Steps Summary: [Clear recap of what customer should do next]
    - Availability Assurance: [Reassurance that help is available if needed]
    - Brand Sign-off: [Professional but warm closing that reflects company values]

  agent: dynamic_responder

# PHASE 9: QUALITY ASSURANCE AND FINAL REVIEW
# ===================================================================

qa_review_task:
  description: >
    Conduct comprehensive quality assurance review of the customer response
    before delivery to ensure excellence and compliance:

    1. **Technical Accuracy Verification**: Verify all technical information,
       procedures, and solutions are correct and complete
    2. **Policy Compliance Review**: Ensure response adheres to all company
       policies, legal requirements, and industry regulations
    3. **Tone and Professionalism Assessment**: Evaluate response tone,
       empathy level, and professional communication standards
    4. **Completeness Evaluation**: Verify that response fully addresses
       customer query and provides complete solution path
    5. **Customer Experience Optimization**: Assess response from customer
       perspective for clarity, helpfulness, and satisfaction potential
    6. **Final Approval Decision**: Make final approval decision or recommend
       specific improvements before customer delivery

    **Input Context:**
    - Draft Response: {dynamic_response_task}
    - Original Customer Query: {topic}
    - Solution Accuracy: Technical correctness of proposed solutions
    - Policy Compliance: Alignment with company policies and procedures

  expected_output: >
    **QUALITY ASSURANCE REVIEW REPORT**

    **Technical Review:**
    - Solution Accuracy: [Verification of technical correctness]
    - Procedure Validation: [Confirmation that steps will work as described]
    - Resource Verification: [Validation of links, contacts, and references]
    - Implementation Feasibility: [Assessment of solution practicality]

    **Policy and Compliance Review:**
    - Policy Adherence: [Compliance with all applicable company policies]
    - Legal Compliance: [Alignment with legal and regulatory requirements]
    - Risk Assessment: [Evaluation of potential risks or liabilities]
    - Authorization Verification: [Confirmation of proper approval levels]

    **Customer Experience Evaluation:**
    - Response Clarity: [How clearly the solution is communicated]
    - Tone Appropriateness: [Match between tone and customer situation]
    - Completeness Assessment: [Whether customer query is fully addressed]
    - Satisfaction Potential: [Likelihood of customer satisfaction with response]

    **Final Assessment:**
    - Overall Quality Score: [1-10 rating of response quality]
    - Approval Status: [Approved/Needs Revision/Requires Escalation]
    - Improvement Recommendations: [Specific suggestions for enhancement]
    - Delivery Readiness: [Ready for customer delivery or needs additional work]

    **Action Recommendations:**
    - Immediate Actions: [Any urgent fixes needed before delivery]
    - Enhancement Suggestions: [Ways to improve response quality]
    - Follow-up Requirements: [What follow-up actions are recommended]
    - Learning Opportunities: [Insights for improving future responses]

  agent: qa_agent

# PHASE 10: CONVERSATION PERSISTENCE AND LEARNING
# ===================================================================

conversation_persistence_task:
  description: >
    Capture, store, and organize conversation data for future reference,
    system improvement, and enhanced personalization:

    1. **Conversation Archiving**: Store complete conversation thread with
       metadata, classifications, and outcome information
    2. **Solution Effectiveness Tracking**: Record solution success rates,
       customer feedback, and resolution outcomes
    3. **Knowledge Base Updates**: Identify opportunities to improve internal
       knowledge base based on query patterns and external information used
    4. **Pattern Recognition**: Analyze conversation for trends, common issues,
       and opportunities for process improvement
    5. **Customer Profile Enhancement**: Update customer profile with interaction
       outcomes, preferences, and satisfaction indicators
    6. **Privacy and Security Compliance**: Ensure all data storage complies
       with privacy policies, data retention rules, and security requirements

    **Input Context:**
    - Complete Conversation: All task outputs and customer interactions
    - Quality Assessment: {qa_review_task}
    - Customer Feedback: Any satisfaction scores or feedback provided
    - Resolution Outcome: Whether issue was resolved successfully

  expected_output: >
    **CONVERSATION PERSISTENCE REPORT**

    **Data Archival:**
    - Conversation ID: [Unique identifier for this support interaction]
    - Data Completeness: [Verification that all conversation data is captured]
    - Metadata Tagging: [Proper categorization and tagging for future retrieval]
    - Privacy Compliance: [Confirmation of data handling policy adherence]

    **Learning Insights:**
    - Solution Effectiveness: [Assessment of how well solutions worked]
    - Knowledge Gaps Identified: [Areas where knowledge base needs improvement]
    - Process Improvements: [Suggestions for enhancing support workflow]
    - Customer Insights: [Understanding gained about customer preferences]

    **System Updates:**
    - Knowledge Base Updates: [Recommended additions or corrections]
    - Policy Clarifications: [Areas where policies may need clarification]
    - Training Opportunities: [Skills or knowledge gaps identified in support process]
    - Technology Enhancements: [Suggestions for system or tool improvements]

    **Follow-up Actions:**
    - Customer Follow-up: [Recommended follow-up timeline and method]
    - Internal Actions: [Any internal tasks or escalations required]
    - System Updates: [Updates to customer profile, knowledge base, or procedures]
    - Monitoring Requirements: [What outcomes should be monitored over time]

  agent: conversation_persister
